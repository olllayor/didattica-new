{% extends "base.html" %}
{% load static %}

{% block content %}
<!-- Main container with light gray background -->
<div class="min-h-screen bg-[#fafafa] py-4">
    <!-- Feed container with white background and rounded corners -->
    <div class="max-w-xl mx-auto bg-white rounded-2xl overflow-hidden shadow-sm">
        <!-- Header -->
        <div class="p-4 border-b sticky top-0 bg-white z-10">
            <div class="flex justify-between items-center">
                <h1 class="text-xl font-bold">For you</h1>
                <button class="p-2 hover:bg-gray-100 rounded-full">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M6 9l6 6 6-6"/>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Posts Feed -->
        <div class="divide-y">
            {% for post in posts %}
            <article class="p-4 hover:bg-gray-50 transition-colors duration-150">
                <!-- Post Header -->
                <div class="flex justify-between">
                    <div class="flex gap-3">
                        <div class="w-10 h-10 rounded-full bg-gray-200 overflow-hidden flex-shrink-0">
                            <img src="{% if post.author.profile_image %}{{ post.author.profile_image.url }}{% else %}{% static 'placeholder.svg' %}{% endif %}" 
                                 alt="{{ post.author.username }}" 
                                 class="w-full h-full object-cover">
                        </div>
                        <div>
                            <div class="flex items-center gap-1">
                                <span class="font-bold">{{ post.author.username }}</span>
                                {% if post.author.is_verified %}
                                <span class="text-blue-500">
                                    <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                </span>
                                {% endif %}
                                <span class="text-gray-500">Â· {{ post.created_at|timesince }}</span>
                            </div>
                        </div>
                    </div>
                    <button class="p-2 hover:bg-gray-100 rounded-full">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="1"/>
                            <circle cx="19" cy="12" r="1"/>
                            <circle cx="5" cy="12" r="1"/>
                        </svg>
                    </button>
                </div>

                <!-- Post Content -->
                {% if post.content %}
                <div class="mt-3 whitespace-pre-wrap">{{ post.content }}</div>
                {% endif %}

                <!-- Post Images -->
                {% if post.post_images.all %}
                <div class="mt-4 overflow-x-auto scrollbar-hide">
                    <div class="flex gap-2">
                        {% for image in post.post_images.all %}
                        <div class="relative aspect-square w-60 md:w-80 rounded-xl overflow-hidden flex-shrink-0">
                            <img
                                src="{{ image.image.url }}"
                                alt="Post image"
                                class="object-cover w-full h-full cursor-pointer"
                                onclick="openImagePreviewModal([{% for img in post.post_images.all %}'{{ img.image.url }}'{% if not forloop.last %},{% endif %}{% endfor %}], {{ forloop.counter0 }})"
                            />
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% elif post.image %}
                <div class="mt-4">
                    <img
                        src="{{ post.image.url }}"
                        alt="Post image"
                        class="rounded-xl w-full object-cover cursor-pointer"
                        onclick="openImagePreviewModal(['{{ post.image.url }}'], 0)"
                    />
                </div>
                {% endif %}

                <!-- Post Actions -->
                <div class="flex justify-between mt-3">
                    <button class="flex items-center gap-2 text-gray-500 hover:text-pink-600 group">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"/>
                        </svg>
                        <span>{{ post.likes_count }}</span>
                    </button>
                    <button class="flex items-center gap-2 text-gray-500 hover:text-blue-500">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 20.25c4.97 0 9-3.694 9-8.25s-4.03-8.25-9-8.25S3 7.444 3 12c0 2.104.859 4.023 2.273 5.48.432.447.74 1.04.586 1.641a4.483 4.483 0 01-.923 1.785A5.969 5.969 0 006 21c1.282 0 2.47-.402 3.445-1.087.81.22 1.668.337 2.555.337z"/>
                        </svg>
                        <span>{{ post.comments_count }}</span>
                    </button>
                    <button class="flex items-center gap-2 text-gray-500 hover:text-green-500">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3"/>
                        </svg>
                        <span>{{ post.reposts_count }}</span>
                    </button>
                    <button class="flex items-center gap-2 text-gray-500 hover:text-blue-500">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"/>
                        </svg>
                    </button>
                </div>
            </article>
            {% empty %}
            <div class="p-4 text-center text-gray-500">
                No posts yet
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}